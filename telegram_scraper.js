// Comprehensive error handling logic added